<!--
*
* (c) Copyright Ascensio System SIA 2020
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
-->

<header>
  <a href="/">
    <img src=<%= asset_path "logo.png" %> alt="ONLYOFFICE"/>
  </a>
</header>
<%=  flash[:notice] %>
<div class="main-panel">
  <span class="portal-name">ONLYOFFICE Document Builder â€“ Welcome!</span>
  <span class="portal-descr">Get started with a demo-sample of ONLYOFFICE Document Builder. You may upload your own script for documents using the <b>Upload script</b> button and selecting the necessary file on your PC.</span>

  <div class="help-block">
    <span>Generate a document from the script below, edit it or upload your own script</span>
    <p>Use the script in the textarea below as is to generate the document or you edit it in the textarea window. Or, in case you have a script of your own, use the button under the textarea to upload it.</p>
    <div class="clearFix">

      <%= form_tag({action: :index}, multipart: true, id: 'load_and_build') do %>
          <%= text_area_tag 'predefinedScript', @sample_code, :spellcheck => false  %>
          <div class="upload-panel clearFix">
            <a class="file-upload">Upload your own script
                  <%= file_field_tag 'uploadedFile', id: 'fileupload', onchange: 'this.form.submit();' %>
            </a>
            <div class="generate-button-upload">
              <a class="button-white" onclick="$('#load_and_build').submit()">Generate document</a>
            </div>


            <p>Visit <a target="_blank" href="https://api.onlyoffice.com/docbuilder/basic">ONLYOFFICE Document Builder documentation</a> for more script examples.</p>
          </div>
      <% end %>


      <div class="create-panel clearFix">
        <span>Or create a new file from a sample script with your own data</span>
        Fill the data into the text areas below so that it could appear in the output document. Or leave it blank, in
        this case the default values (now shown as watermarks in the text area) will be added to the resulting document.

        <%= form_tag('upload_data', action: :upload_data, multipart: true, :id => 'download-form') do %>
            <ul class="try-editor-list clearFix">
              <li>
                <a class="try-editor document reload-page" target="_blank" onclick="$('#docx').click()">Create
                  <br/>
                  Document</a>
                <%= submit_tag('', :id => 'docx', :class => 'hidden', :value => 'docx') %>
              </li>
              <li>
                <a class="try-editor spreadsheet reload-page" target="_blank" onclick="$('#xlsx').click()">Create
                  <br/>
                  Spreadsheet</a>
                <%= submit_tag('', :id => 'xlsx', :class => 'hidden', :value => 'xlsx') %>
              </li>
              <li>
                <a class="try-editor presentation reload-page" target="_blank" onclick="$('#pdf').click()">Create
                  <br/>
                  PDF</a>
                <%= submit_tag('', :id => 'pdf', :class => 'hidden', :value => 'pdf') %>
              </li>
            </ul>
            <div class="own-data-enter">
              <label>Name: </label>
              <%= text_field_tag 'input_name', 'name', 'data-watermark' => "John Smith" %>
              <label>Company: </label>
              <%= text_field_tag 'input_company', 'company', 'data-watermark' => "ONLYOFFICE" %>
              <label>Position/Title: </label>
              <%= text_field_tag 'input_position', 'position', 'data-watermark' => "Commercial director" %>
            </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="help-block">
    <span>Want to learn the magic?</span>
    Explore ONLYOFFICE Document Builder
    <a href="http://helpcenter.onlyoffice.com/developers/document-builder/index.aspx" target="_blank">documentation.</a>
  </div>
  <div class="help-block">
    <span>Any questions?</span>
    Please, <a href="mailto:sales@onlyoffice.com">submit your request here</a>.
  </div>
</div>
<footer>&copy; Ascensio Systems SIA 2020. All rights reserved.</footer>
